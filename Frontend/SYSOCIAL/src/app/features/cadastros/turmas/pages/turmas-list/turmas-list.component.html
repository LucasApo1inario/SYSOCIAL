<div class="user-list-container">
  <h1 class="text-2xl font-bold mb-4">Turmas</h1>

  <div class="flex flex-col md:flex-row gap-2 mb-6">
    <input
      z-input
      [ngModel]="search"
      (ngModelChange)="search = $event"
      zSize="default"
      placeholder="Pesquisar turmas..."
    />
    <z-button zType="default" (click)="addTurma()">+ Nova Turma</z-button>
  </div>

  @if (loading()) {
    <div class="flex justify-center items-center h-48">
      <p class="text-gray-500">Carregando turmas...</p>
    </div>
  } @else {
    <div class="mb-4 flex items-center gap-4">
      <label class="text-sm font-medium">
        Itens por página:
        <select
          z-input
          [ngModel]="itemsPerPage()"
          (ngModelChange)="onItemsPerPageChange($event)"
          class="ml-2"
          zSize="default"
        >
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
        </select>
      </label>
      <span class="text-sm text-gray-500">
        Mostrando {{ displayedTurmas().length }} de {{ filteredTurmas().length }} turmas
      </span>
    </div>

    <app-turma-table
      [turmas]="displayedTurmas()"
      (edit)="editTurma($event)"
      (delete)="deleteTurma($event)"
      (viewAlunos)="viewTurmaAlunos($event)"
    ></app-turma-table>

    <!-- Paginação -->
    @if (totalPages() > 1) {
      <div class="flex justify-center items-center gap-2 mt-6">
        <z-button
          zType="ghost"
          zSize="sm"
          (click)="previousPage()"
          [attr.disabled]="currentPage() === 1 ? true : null"
        >
          Anterior
        </z-button>

        @for (page of [].constructor(totalPages()); let i = $index; track i) {
          <button
            z-button
            [zType]="currentPage() === i + 1 ? 'default' : 'ghost'"
            zSize="sm"
            (click)="goToPage(i + 1)"
          >
            {{ i + 1 }}
          </button>
        }

        <z-button
          zType="ghost"
          zSize="sm"
          (click)="nextPage()"
          [attr.disabled]="currentPage() === totalPages() ? true : null"
        >
          Próxima
        </z-button>
      </div>
    }
  }

  <!-- Modal de Alunos -->
  @if (showAlunosModal() && selectedTurma()) {
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto">
        <app-turma-alunos
          [turma]="selectedTurma()!"
          (close)="closeAlunosModal()"
        ></app-turma-alunos>
      </div>
    </div>
  }
</div>
